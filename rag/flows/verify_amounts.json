{
  "name": "Retrieve booking and capture Total Amount Paid",
  "intent": "verify_amounts",
  "inputs": { "bookingId": "G22232" },
  "steps": [
    { "action": "goto", "url": "https://sit1.royalx.rccl.com/iTravel/shopping/static/7.0.296/en_US/A5/pages/peacoc-index.html#/", "waitUntil": "domcontentloaded", "description": "Navigate to the Selling App page" },
    { "action": "click", "module": "selling-app", "locator": "RetrieveBookingsTab", "description": "Click on Retrieve Bookings tab" },
    { "action": "fill", "module": "selling-app", "locator": "BookingIdInput", "valueFrom": "bookingId", "description": "Fill in the Booking ID" },
    { "action": "click", "module": "selling-app", "locator": "SearchButton", "description": "Click the Search button" },
    { "action": "waitForLoadState", "state": "networkidle", "description": "Wait for network to be idle" },
    { "action": "captureText", "module": "selling-app", "locator": "TotalAmountPaidSpan", "var": "totalAmountPaid", "description": "Capture the Total Amount Paid" },

    { "action": "goto", "url": "https://sit1.royalx.rccl.com/iTravel/production/static/7.0.300/en_US/base/pages/index.html", "waitUntil": "domcontentloaded", "description": "Navigate to Accounting module" },
    { "action": "click", "module": "finance-accounting", "locator": "HamburgerMenu", "description": "Click hamburger menu" },
    { "action": "click", "module": "finance-accounting", "locator": "FinanceMenuItem", "description": "Click Finance & Accounting menu item" },
    { "action": "click", "module": "finance-accounting", "locator": "BookingEnquiriesLink", "description": "Click Booking Enquiries link" },
    { "action": "click", "module": "finance-accounting", "locator": "BookingFinancialEnquiryLink", "description": "Click Booking Financial Enquiry link" },
    { "action": "fill", "module": "finance-accounting", "locator": "BookingSearchInput", "valueFrom": "bookingId", "description": "Fill in booking number in Accounting module" },
    { "action": "blur", "module": "finance-accounting", "locator": "BookingSearchInput", "description": "Trigger blur event to load financial details" },
    { "action": "waitForLoadState", "state": "networkidle", "description": "Wait for network idle after blur" },
    { "action": "click", "module": "finance-accounting", "locator": "ViewDetailsButton", "description": "Click View Details button" },
    { "action": "waitForLoadState", "state": "networkidle", "description": "Wait for network idle after View Details" },
    { "action": "captureValue", "module": "finance-accounting", "locator": "TotalReceivedInput", "var": "accountingAmountPaid", "description": "Capture Total Received from Accounting" },

    { "action": "normalizeAmount", "var": "totalAmountPaid", "outVar": "normalizedSellingAmount", "description": "Normalize Selling App amount" },
    { "action": "normalizeAmount", "var": "accountingAmountPaid", "outVar": "normalizedAccountingAmount", "description": "Normalize Accounting amount" },
    { "action": "assertEqual", "left": "normalizedAccountingAmount", "right": "normalizedSellingAmount", "description": "Compare Selling vs Accounting amounts" }
  ]
}
